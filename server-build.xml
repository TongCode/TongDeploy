<?xml version="1.0" encoding="utf-8"?>
<project name="cywh-server" basedir="." default="help">
	
	<import file="task/project.xml"/>
	<import file="task/svn.xml"/>
	<import file="task/file.xml"/>
	<import file="task/maven.xml"/>

	<!-- 项目参数配置 -->
	<property file="${basedir}/build.properties" />

	<!-- 初始化项目空间 -->
	<target name="init" description="init projet">
		<antcall target="pro-create"/>
	</target>
	
	<!-- 初始化项目代码 -->
	<target name="checkout" description="svn checkout">
		<property name="svn.url" value="${svn.server.url}" />
		<property name="svn.user" value="${svn.server.user}" />
		<property name="svn.pwd" value="${svn.server.pwd}" />
		<property name="svn.dir" value="${project.src.dir}" />
		<antcall target="svn-checkout"/>
	</target>
	
	<!-- maven 编译项目 -->
	<target name="compile" description="mvn compile">
		<property name="maven.exe.path" value="${project.src.dir}" />
		<property name="maven.exe.param" value="compile" />
		<antcall target="maven"/>
	</target>
	
	<!-- maven 清除项目 -->
	<target name="clean" description="mvn clean">
		<property name="maven.exe.path" value="${project.src.dir}" />
		<property name="maven.exe.param" value="clean" />
		<antcall target="maven"/>
	</target>
	
	<!-- maven 打包项目 -->
	<target name="package" description="mvn package">
		<property name="maven.exe.path" value="${project.src.dir}" />
		<property name="maven.exe.param" value="package" />
		<antcall target="maven"/>
	</target>

	<!-- NodeJs 项目启动 -->
	<target name="start" description="web start">
		<property name="nodejs.start.dir" value="${dist.web.dir}" />
		<property name="nodejs.start.param" value="bin/www" />
		<antcall target="nodejs-start"/>
	</target>
	
	<!-- Web 项目部署 -->
	<target name="deploy" description="web deploy" depends="checkout">
		<echo message="deploy project..."/>
		<property name="copy.to" value="${dist.web.dir}" />
		<property name="copy.from" value="${project.src.dir}" />
		<antcall target="copydir"/>
	</target>
	
	<!-- 项目自动部署 -->
	<target name="auto" description="自动部署" depends="deploy,start">
		<echo message="部署完成，谢谢您的使用！"/>
	</target>
</project>